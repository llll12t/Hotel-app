<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <title>จองห้องพัก - หน้าแรก</title>
    <!-- Tailwind CSS via CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@3.2.7/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <!-- LIFF SDK (กรณีต้องการใช้) -->
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  </head>
  <body class="bg-gray-100 min-h-screen">
    <div class="max-w-md mx-auto p-4">
      <!-- ส่วนหัว -->
      <div class="flex items-center justify-between mb-4">
        <h1 class="text-lg font-bold">โอมสเตย์ ยินดีต้อนรับ</h1>
        <!-- ตัวอย่างไอคอน/โปรไฟล์ -->
        <div class="w-10 h-10 bg-gray-300 rounded-full"></div>
      </div>

      <!-- เลือกวันที่เข้าพัก (ดีไซน์เป็นแบบปุ่มแคปซูล) -->
      <div
        class="flex items-center bg-white rounded-full px-4 py-2 mb-6 shadow-sm"
      >
        <label for="checkInDate" class="text-sm text-gray-500">
          วันที่เข้าพัก
        </label>
        <input
          type="date"
          id="checkInDate"
          class="text-sm text-right ml-auto focus:outline-none"
          value="2025-03-18" <!-- ใส่ค่า default หรือ format ที่ต้องการ -->
        />
      </div>

      <!-- หัวข้อห้องที่ว่าง -->
      <h2 class="mb-3 font-semibold text-gray-700">ห้องที่ว่าง ว่างอยู่</h2>

      <!-- ส่วนรายการห้องพัก -->
      <div id="roomList" class="space-y-4">
        <!-- จะใส่ข้อมูลห้องแบบไดนามิกด้วย JS (renderRoomList) -->
      </div>
    </div>

    <script>
      // URL ของ Google Apps Script Web App ที่คืนค่า JSON
      const apiUrl = "https://script.google.com/macros/s/AKfycbxu7WHS2auKFROs9m6Dmep6DWOflEtCEkdsZZbIJ-fGGqQ1BJBxn5g18A3HTkObmg9f/exec";

      // เรียกข้อมูลห้องจาก API
      async function fetchRooms() {
        try {
          const response = await fetch(apiUrl);
          const data = await response.json();
          renderRoomList(data);
        } catch (err) {
          console.error("Error fetching rooms:", err);
        }
      }

      // สร้าง UI รายการห้อง
      function renderRoomList(rooms) {
        const container = document.getElementById("roomList");
        container.innerHTML = ""; // เคลียร์ก่อน

        rooms.forEach((room) => {
          // สร้าง card หลัก
          const card = document.createElement("div");
          card.className =
            "flex items-center bg-white rounded-lg p-3 shadow";

          // รูปภาพห้อง
          const img = document.createElement("img");
          img.src = room["รูปภาพ"];
          img.alt = room["ชื่อ"];
          img.className = "w-20 h-20 object-cover rounded-md mr-3";

          // ส่วนกลาง: ชื่อห้อง + หมวดหมู่ + (ตัวอย่าง) ฟีเจอร์
          const info = document.createElement("div");
          info.className = "flex-1";

          const title = document.createElement("div");
          title.className = "font-semibold text-sm";
          title.textContent = room["ชื่อ"];

          // ตัวอย่างรวมฟีเจอร์ต่าง ๆ (ถ้าเป็น TRUE)
          const features = [];
          if (String(room["แอร์"]).toLowerCase() === "true") features.push("แอร์");
          if (String(room["ที่จอดรถ"]).toLowerCase() === "true") features.push("ที่จอดรถ");
          if (String(room["สระน้ำ"]).toLowerCase() === "true") features.push("สระน้ำ");
          if (String(room["วิว"]).toLowerCase() === "true") features.push("วิว");

          const featuresText = features.join(" • ");
          const featureElem = document.createElement("div");
          featureElem.className = "text-xs text-gray-500 mt-1";
          featureElem.textContent = featuresText;

          info.appendChild(title);
          info.appendChild(featureElem);

          // ส่วนขวา: ราคา + ปุ่ม
          const rightBox = document.createElement("div");
          rightBox.className = "text-right ml-2";

          const price = document.createElement("div");
          price.className = "text-red-500 font-bold text-lg";
          price.textContent = room["ราคา"] || "0";

          // ปุ่ม “เลือก” (หรือ “ดูรายละเอียด”)
          const button = document.createElement("a");
          button.href = `detail.html?id=${room["ไอดี"]}`; // ลิงก์ไปหน้า detail
          button.className =
            "bg-pink-500 text-white text-sm px-4 py-1 rounded inline-block mt-2";
          button.textContent = "เลือก";

          rightBox.appendChild(price);
          rightBox.appendChild(button);

          // ประกอบทั้งหมดลงใน card
          card.appendChild(img);
          card.appendChild(info);
          card.appendChild(rightBox);

          // ใส่ card ลงใน container
          container.appendChild(card);
        });
      }

      // เมื่อโหลดหน้าเสร็จ ให้ดึงข้อมูลห้อง
      document.addEventListener("DOMContentLoaded", () => {
        // ถ้าจะใช้ LIFF: initLiff();
        fetchRooms();
      });

      // ตัวอย่างฟังก์ชัน LIFF (หากต้องการใช้งาน)
      // async function initLiff() {
      //   await liff.init({ liffId: "YOUR_LIFF_ID" });
      //   if (!liff.isLoggedIn()) {
      //     liff.login();
      //   }
      // }
    </script>
  </body>
</html>
